<!DOCTYPE html>
<html>
  <head>
    <title>Tremor Tracker</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
      import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

      // ðŸ”¹ Config Firebase Anda
      const firebaseConfig = {
        apiKey: "AIzaSyCUpSrDPRTvLOot4e4QboWgdJLj_PQByn8",
        authDomain: "parkinson-11301.firebaseapp.com",
        databaseURL: "https://parkinson-11301-default-rtdb.firebaseio.com",
        projectId: "parkinson-11301",
        storageBucket: "parkinson-11301.appspot.com",
        messagingSenderId: "779006164225",
        appId: "779006164225"
      };

      // Inisialisasi Firebase
      const app = initializeApp(firebaseConfig);
      const database = getDatabase(app);

      // ðŸ”¹ Ubah path sesuai struktur Firebase Anda
      const tremorRef = ref(database, "tremor_data/esp32_tremor_01/history/latest")

 let ctx = null;
      let tremorChart = null;
      window.onload = function () {
        ctx = document.getElementById("tremorChart").getContext("2d");
        tremorChart = new Chart(ctx, {
          type: "line",
          data: {
            labels: [],
            datasets: [
              {
                label: "Tremor Magnitude",
                data: [],
                borderColor: "red",
                borderWidth: 2,
                fill: false,
              },
            ],
          },
          options: {
            responsive: true,
            animation: false,
            scales: {
              x: { display: true },
              y: { display: true },
            },
          },
        });
      };

      // Update grafik dari Firebase
      onValue(tremorRef, (snapshot) => {
        const data = snapshot.val();
        if (data) {
          tremorChart.data.labels = [];
          tremorChart.data.datasets[0].data = [];

          Object.values(data).forEach((entry) => {
            if (entry.magnitude !== undefined) {
              const timeLabel = new Date(entry.timestamp_ms).toLocaleTimeString();
              tremorChart.data.labels.push(timeLabel);
              tremorChart.data.datasets[0].data.push(entry.magnitude); 
            } 
          });


          tremorChart.update();
        }
      });
    </script>
  </head>
  <body>
    <h2>Tremor Magnitude Realtime</h2>
    <canvas id="tremorChart" width="600" height="400"></canvas>
  </body>
</html>












